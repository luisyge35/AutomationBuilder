"use strict";module.exports=function(r){require("source-map-support").install();var i=require("./core/opcua-iiot-core-discovery");r.nodes.registerType("OPCUA-IIoT-Discovery",function(e){r.nodes.createNode(this,e),this.name=e.name,this.discoveryPort=e.discoveryPort||i.DEFAULT_OPCUA_DISCOVERY_PORT;var o=this;o.bianco=i.core.createBiancoIIoT(),i.core.assert(o.bianco.iiot);var t=new i.core.nodeOPCUA.OPCUADiscoveryServer({port:o.discoveryPort});o.status({fill:"yellow",shape:"ring",text:"starting"}),i.detailDebugLog("discovery endpoints:"+t._get_endpoints()),t.start(function(){i.internalDebugLog("discovery server started"),o.status({fill:"green",shape:"dot",text:"active"})}),o.on("input",function(e){e.payload={discoveryUrls:t.getDiscoveryUrls()||[],endpoints:t.endpoints||[]},o.send(e)}),o.on("close",function(e){t?t.shutdown(function(){i.internalDebugLog("shutdown"),e()}):e()})})};
//# sourceMappingURL=maps/opcua-iiot-discovery.js.map
