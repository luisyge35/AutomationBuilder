var t,n;t=this,n=function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var n;(n=t.InterpreterStatus||(t.InterpreterStatus={}))[n.NotStarted=0]="NotStarted",n[n.Running=1]="Running",n[n.Stopped=2]="Stopped";var e={type:"xstate.init"},r="xstate.assign";function i(t){return void 0===t?[]:[].concat(t)}function o(t,n){return"string"==typeof(t="string"==typeof t&&n&&n[t]?n[t]:t)?{type:t}:"function"==typeof t?{type:t.name,exec:t}:t}function a(t){return function(n){return t===n}}function u(t){return"string"==typeof t?{type:t}:t}function c(t,n){return{value:t,context:n,actions:[],changed:!1,matches:a(t)}}var s=function(t,n){return t.actions.forEach((function(e){var r=e.exec;return r&&r(t.context,n)}))};t.assign=function(t){return{type:r,assignment:t}},t.createMachine=function(t,n){void 0===n&&(n={});var e={config:t,_options:n,initialState:{value:t.initial,actions:i(t.states[t.initial].entry).map((function(t){return o(t,n.actions)})),context:t.context,matches:a(t.initial)},transition:function(n,s){var f,p,l="string"==typeof n?{value:n,context:t.context}:n,d=l.value,v=l.context,y=u(s),g=t.states[d];if(g.on){var x=i(g.on[y.type]),S=function(n){if(void 0===n)return{value:c(d,v)};var i="string"==typeof n?{target:n}:n,u=i.target,s=void 0===u?d:u,f=i.actions,p=void 0===f?[]:f,l=i.cond,x=v;if((void 0===l?function(){return!0}:l)(v,y)){var S=t.states[s],m=!1,h=[].concat(g.exit,p,S.entry).filter((function(t){return t})).map((function(t){return o(t,e._options.actions)})).filter((function(t){if(t.type===r){m=!0;var n=Object.assign({},x);return"function"==typeof t.assignment?n=t.assignment(x,y):Object.keys(t.assignment).forEach((function(e){n[e]="function"==typeof t.assignment[e]?t.assignment[e](x,y):t.assignment[e]})),x=n,!1}return!0}));return{value:{value:s,context:x,actions:h,changed:s!==d||h.length>0||m,matches:a(s)}}}};try{for(var m=function(t){var n="function"==typeof Symbol&&t[Symbol.iterator],e=0;return n?n.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}(x),h=m.next();!h.done;h=m.next()){var b=S(h.value);if("object"==typeof b)return b.value}}catch(t){f={error:t}}finally{try{h&&!h.done&&(p=m.return)&&p.call(m)}finally{if(f)throw f.error}}}return c(d,v)}};return e},t.interpret=function(n){var r=n.initialState,i=t.InterpreterStatus.NotStarted,o=new Set,a={_machine:n,send:function(e){i===t.InterpreterStatus.Running&&(r=n.transition(r,e),s(r,u(e)),o.forEach((function(t){return t(r)})))},subscribe:function(t){return o.add(t),t(r),{unsubscribe:function(){return o.delete(t)}}},start:function(){return i=t.InterpreterStatus.Running,s(r,e),a},stop:function(){return i=t.InterpreterStatus.Stopped,o.forEach((function(t){return o.delete(t)})),a},get status(){return i}};return a},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).XStateFSM={});
